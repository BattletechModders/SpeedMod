on: push
name: CI

jobs:
  build:
    uses: BattletechModders/ModTek/.github/workflows/mod-builder.yml@master
    with:
      checkout-directory: 'BATTLETECH/Mods/SpeedMod'
      build-script: |
        dotnet build --configuration Release -p:BattleTechGameDir="$BATTLETECH_DIR/"
        (
        cd ..
        INCLUDES="-i!SpeedMod/SpeedMod.dll -i!SpeedMod/LICENSE -i!SpeedMod/mod.json -i!SpeedMod/Settings.json -i!SpeedMod/README.md -ir!SpeedMod/StreamingAssets -ir!SpeedMod/advancedjsonmerge"
        7z a -tzip -mx9 "$DIST_DIR/SpeedMod.zip" $INCLUDES
        )
      release-notes: |
        Works best with ModTek V3
        - SpeedMod.zip contains the mod
    secrets: inherit
